---
title: "`{getTBinR}`"
subtitle: "An R package for accessing and summarising World Health Organization Tuberculosis data"
author: "Sam Abbott (@seabbs)"
institute: "University of Bristol"
date: "2019/09/14"
output:
  xaringan::moon_reader:
    css: ["default", "default-fonts", "theme.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
class: inverse
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

knitr::opts_chunk$set(echo = TRUE, dpi = 330, fig.align = 'center', dev = 'svg')

library(getTBinR)
library(tidyverse)
```


# Outline

0. Overview

1. Why

2. What

3. How

4. Can I do something similar?

---
class: center, middle, inverse

# Overview

---

# Overview

```{r echo = FALSE, fig.height = 5}
knitr::include_graphics("img/ExploreGlobalTB.png")
```

.footnote[
[1] Package Docs: [bit.ly/getTBinR](https://bit.ly/getTBinR)
]
---
class: center, middle, inverse

# Why

---

# Why data access packages

---

# Why does Tuberculosis matter


---

# Why tools?

---
class: center, middle, inverse

# What

---

# World Health Organisation TB data

* The WHO provide multiple cleaned datasets via their [website](https://www.who.int/tb/country/data/download/en/). ALll datasets are supported by a comprehensive data dictionary.

* Also have an API through which other datasets can be accessed but these tend to be messy. 

```{r who-data, out.width = "80%", echo = FALSE}
knitr::include_graphics("img/who-data.png")
```

---

# What data is available?

```{r what-datasets}
getTBinR::available_datasets %>% 
  dplyr::select(dataset, description)
```

---

# Get the WHO TB burden data

```{r get-tb-data}
getTBinR::get_tb_burden(verbose = FALSE,
                        additional_datasets = "all") %>% 
  print(tb_burden, n = 3, n_extra = 10)
```
---

# Get the WHO TB data dictionary

```{r get-dict}
getTBinR::get_data_dict(verbose = FALSE) %>% 
  print(n = 3, n_extra = 10)
```

---

# Search for a dataset

```{r search-dataset}
getTBinR::search_data_dict(dataset = "Estimates",
                           verbose = FALSE) %>% 
  dplyr::slice(1:3) %>% 
  knitr::kable("html")
```

---

# Search for a variable

```{r search-var}
getTBinR::search_data_dict(var = "e_inc_100k",
                           verbose = FALSE) %>% 
  knitr::kable("html")
```
---

# Search within variable definitions

```{r search-def}
getTBinR::search_data_dict(def = "incidence",
                           verbose = FALSE) %>% 
  dplyr::slice(1:3) %>% 
  knitr::kable("html")
```

---

# Plot a summary

```{r summarise-tb, fig.height = 4, dev = 'svg'}
getTBinR::plot_tb_burden_summary(conf = NULL, verbose = FALSE)
```

---

# Map

```{r map-global-inc, fig.height = 4, dev = 'svg', fig.align='center'}
getTBinR::map_tb_burden(metric = "e_inc_100k", verbose = FALSE, 
                        interactive = FALSE)
```

---

# Get the 10 countries with highest incidence rates in 2017

```{r get-high-inc-countries, echo = TRUE}
high_inc_countries <- tb_burden %>% 
  dplyr::filter(year == 2017) %>% 
  dplyr::arrange(desc(e_inc_100k)) %>% 
  dplyr::slice(1:10) %>% 
  dplyr::pull(country) %>% 
  unique

high_inc_countries
```
---

# Overview

```{r plot-tb-inc-overview, fig.height = 4, dev = 'svg'}
getTBinR::plot_tb_burden_overview(metric = "e_inc_100k", 
                                  countries = high_inc_countries,
                                  verbose = FALSE)
```
---

# Trends over time

```{r plot-inc-by-country, fig.height = 4, dev = 'svg'}
getTBinR::plot_tb_burden(metric = "e_inc_100k",  
               countries = high_inc_countries,
               facet = "country", scales = "free_y",
               verbose = FALSE)

```

---

# `{shiny}` dashboard

```{r, eval = FALSE}
getTBinR::run_tb_dashboard()
```

```{r dashboard-img, echo = FALSE}
knitr::include_graphics("img/ExploreGlobalTB.png")
```
---

# `{rmarkdown}` report

```{r, eval = FALSE}
getTBinR::render_country_report()
```

```{r dashboard-img-2, echo = FALSE}
knitr::include_graphics("img/ExploreGlobalTB.png")
```

---

class: center, middle, inverse

# More examples

---

# Example: 

```{r echo = FALSE, fig.height = 5}
knitr::include_graphics("img/ExploreGlobalTB.png")
```


---

# Example: 

```{r echo = FALSE, fig.height = 5}
knitr::include_graphics("img/ExploreGlobalTB.png")
```


---

# Example: 

```{r echo = FALSE, fig.height = 5}
knitr::include_graphics("img/ExploreGlobalTB.png")
```


---

# Example: 

```{r echo = FALSE, fig.height = 5}
knitr::include_graphics("img/ExploreGlobalTB.png")
```


---

# Example: 

```{r echo = FALSE, fig.height = 5}
knitr::include_graphics("img/ExploreGlobalTB.png")
```


---

```{r echo = FALSE, fig.height = 5}
knitr::include_graphics("img/ExploreGlobalTB.png")
```


---

class: center, middle, inverse

# Promotion

---

# Blog posts

Multiple case studies that were first released as blog posts<sup>1</sup> - via [Rweekly.org](Rweekly.org) - and then adapted into package vignettes.

```{r blog-img, echo = FALSE}
knitr::include_graphics("img/blog.png")
```


.footnote[
[1] See them here: https://www.samabbott.co.uk/tags/who/
]

---

# Gists<sup>1</sup> 

```{r gists-img, echo = FALSE}
knitr::include_graphics("img/gists.png")
```


.footnote[
[1] Gists: [bit.ly/getTBinR-gists](http://bit.ly/getTBinR-gists)
]

---

# #rstats twitter<sup>1</sup> 

Tweet about: new features, examples, using new tools in the package, and anything else involving the package .....

```{r gists-img-2, out.width = "80%", echo = FALSE}
knitr::include_graphics("img/gists.png")
```

.footnote[
[1] `{getTBinR}` on Twitter: [bit.ly/getTBinR-twitter](http://bit.ly/getTBinR-twitter)
]

---

class: inverse, center, middle

# Thanks for listening

## Slides: http://bit.ly/getTBinR-r-medicine

## Paper: http://bit.ly/getTBinR-paper

## Documentation: http://bit.ly/getTBinR

## Personal Website: http://bit.ly/seabbs

## Tweet at me: [@seabbs](https://twitter.com/seabbs)

---

